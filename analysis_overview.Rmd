---
title: "Sentiment Analysis"
author: "Tero Jalkanen"
date: "`r Sys.Date()`"
output: ioslides_presentation
params:
  filter_duplicates: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

## Packages -----------

library(readxl)
library(here)
library(tidyverse)
library(janitor)
library(skimr)
library(tidytext)
library(scales)
library(textdata)
library(RColorBrewer)
library(wordcloud)
library(reshape2)
library(tidymodels)
library(topicmodels)
library(textrecipes)
# methods for imbalanced data sets
library(themis)
library(hardhat)
library(glmnet)
library(stopwords)

## Set file paths
here::i_am("analysis_overview.Rmd")

## Set graphical theme
theme_set(theme_minimal())

```

```{r data-download}

## Get the data
text_df <- readxl::read_excel(path = here("data", "sentences_with_sentiment.xlsx")) %>% 
  # move sentiments under same column
  mutate(sentiment = case_when(
    Positive == 1 ~ "Positive",
    Negative == 1 ~ "Negative",
    Neutral == 1 ~ "Neutral",
    # in case of missing sentiment
    TRUE ~ "missing"
  ), .after = ID) %>% 
  # all column names to lowercase
  janitor::clean_names()

```

```{r data-wrangle}

## Find duplicate sentences ----

# indices
double_ind <- duplicated(text_df$sentence)

# The actual sentences
doubles <- text_df$sentence[double_ind] %>% 
  unique()


```


## Introduction

* Our task is to analyze document containing `r length(text_df$sentence)` sentences written in English

* The sentences have been labelled by Subject Matter Experts (SMEs) as being `positive`, `negative` or `neutral` in tone

* We want to explore the data and see if it would be possible to automate labeling task

```{r}
# Print out label frequencies to show class (im)balance
text_df %>% 
  group_by(sentiment) %>% 
  summarise(n = n()) %>% 
  mutate(percentage = 100*n/length(text_df$sentiment)) %>% 
  knitr::kable(digits = 2, caption = "The sentiment labels for the example sentences")

```


# Exploring the data

## Example sentences

* The sentences are picked from regulatory assessments (a few examples):

<!---
Print out a few example sentences
--->

  - `r doubles[1]`
  
  - `r doubles[2]`
    
  - `r doubles[3]`

* There are `r length(doubles)` sentences which appear at least twice in the data set

## New slide

